# Ch.09 단위 테스트


## TDD
- Test Driven Development (테스트 주도 개발)

## TDD 법칙 세가지

> - **실패하는 단위 테스트**를 작성할 때까지 실제 코드를 작성하지 않는다.
> - **컴파일은 실패하지 않으면서 실행이 실패하는 정도**로만 단위 테스트를 작성한다.
> - 현재 실패하는 테스트를 **통과할 정도로만** 실제 코드를 작성한다.

- 위 같은 법칙을 따른다면..
  - 테스트 코드가 실제 코드보다 불과 몇 초전에 나온다.

하지만 실제 코드와 맞먹을 정도로 방대한 테스트 코드는 심각한 관리 문제를 유발하기도 한다.

어쩜좋아🥺

## 깨끗한 테스트 코드 유지하기
- 테스트 코드가 복잡할수록 실제 코드를 짜는 시간보다 테스트 케이스를 추가하는 시간이 더 걸리기 십상이다.
- **테스트 코드는 실제 코드 못지 않게 중요**하다.
- 테스트 코드는 사고와 설계와 주의가 필요, 실제 코드 못지 않게 **깨끗하게 짜야 한다**

### 테스트는 유연성, 유지보수성, 재사용성을 제공한다
- 이를 제공하는 버팀목이 바로 **단위테스트**
- 테스트 케이스가 없으면 버그가 숨어들까 두렵기 때문에 개발자는 변경을 주저한다. 
- 자동화된 단위 테스트 슈트가 있다면 변경이 쉬워진다.

## 깨끗한 테스트 코드
- 테스트 코드는 최소의 표현으로 많은 것을 나타내야 한다.
- BUILD-OPERATE-CHECK 패턴 (테스트 자료 생성 -> 테스트 자료 조작 -> 결과 확인)
  - 잡다하고 세세한 코드를 거의 다 없앤다.
  - 테스트 코드는 진짜 필요한 자료 유형과 함수만 사용한다.

### 도메인에 특화된 테스트 언어
- 테스트를 구현하는 당사자와 나중에 테스트를 읽어볼 독자를 도와주는 테스트 언어

### 이중 표준 
- 테스트 코드에 사용하는 표준이 실제 코드에 적용하는 표준과는 다르며 실제 코드만큼 효율적일 필요는 없다.
- 메모리나 CPU 효율과 관련이 있는 경우 실제 환경에서는 절대로 안 되지만 테스트 환경에서는 전혀 문제 없는 방식이 있다.

## 테스트 당 assert 하나
- **assert 문이 단 하나인 함수는 결론이 하나라서 코드를 이해하기 쉽고 빠르다**.
- `given-when-then` (준비-실행-검증) 관례는 중복되는 코드가 많아진다.
-  `TEMPLATE METHOD` 패턴 혹은 `@Before` 항수를 사용 가능하지만 준비 코드가 더 길어져 배보다 배꼽이 더 커진다.
  - TEMPLATE METHOD : 변하지 않는 기능은 슈퍼클래스에 만들어두고 확장할 기능은 서브클래스에서 만들기 / 알고리즘 구조는 변경되지 않고 알고리즘의 특정 단계들을 다시 정의 가능 
- 한개면 더 좋지만 **assert 문 개수는 최대한 줄여야 좋다**는 생각

### 테스트 당 개념 하나
- 테스트 함수에 3개의 독립적인 기능을 하는 테스트 코드가 있다면? 이를 세 개의 함수로 나누자.

> 개념 당 assert 문 수를 **최소로 줄여라** 와 테스트 함수 하나는 **개념 하나만** 테스트하라

## FIRST
- 깨끗한 테스트는 다음 다섯가지 규칙을 따른다.
- F(Fast, **빠르게**) : 테스트는 빨리 돌아야 한다
  - 느리면 자주 돌릴 엄두도 못내고 초반에 문제를 찾아내 고치지 못해 코드 품질이 망가지기 시작한다.
- I(Independent, **독립적으로**) : 각 테스트는 서로 의존하면 안 된다.
  - 테스트가 서로에게 의존하면 하나가 실패할 때 나머지도 잇달아 실패하므로 원인을 진단하기 어려워지며 후반 테스트가 찾아내야할 결함이 숨겨진다.
- R(Repeatable, **반복가능하게**) : 어떤 환경에서도 반복 가능해야 한다.
  - QA환경, 네트워크에 연결되지 않은 노트북 등에서도 테스트 실행 가능해야한다.
- S(Self-Validating, **자가검증하는**) : 테스트는 bool 값으로 결과를 내야한다.
  - 성공 아니면 실패
  - 테스트 스스로 성공or실패 를 가늠하지 않는다면 판단은 주관적이 된다.
- T(Timely, **적시에**) : 테스트는 적절한 시기에 해야 한다.
  - 실제 코드를 구현하기 직전에 구현해야 한다. 

## 느낀점
- TDD가 필요하다고 하여 짠다고 작성했던 코드들을 돌이켜보니까 법칙을 지켜서 한 것 같지가 않다.
- 대부분 코드가 실행 성공하면 끝! 하고 끝냈던 것 같아서 반성했고 실패, 컴파일성공&실패, 실패된것을 성공으로 를 지켜서 작성해봐야겠다고 느꼈다.
- 함수도 잘 분리해서 테스트를 위한 테스트코드를 작성해야겠다.
- 책의 결론에서도 TDD 내용은 책 한권으로 공부해도 부족한 내용이라고 하였다. 좀 더 관련 자료나 책을 살펴보고서 더 나은 테스트 주도 개발을 하고 싶다 : )
