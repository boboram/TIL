# Ch.08 경계

(경계? 무슨 경계를 말하는거지? 가 8 챕터 타이틀을 봤을 때 느꼈던 생각이었다. 읽다보니 외부라이브러리 사용에 대한 내용이었다!)

- 외부 코드를 우리 코드에 깔끔하게 통일해야만 한다.

방법이 모죵?🥺

## 외부 코드 사용하기 
- 외부 라이브러리인 Map에는 clear() 메서드가 존재한다. 이는 사용자에게 지울 수 있는 권한이 있다는 것을 의미한다.
- 클라이언트(Map을 사용하는 외부 개발자)가 마음만 먹으면 마음대로 Map을 지우거나 객체 유형을 추가할 수 있다. -> 위험해 보이죵?
```
Map sensors = new HashMap();

Sensor s = (Sensor)sensors.get(sensorId);
```
- 맵을 올바른 유형으로 변환할 **책임은 클라이언트에게 있다**

위 코드는 조금 구리다. 맵이 무슨 유형인지도 모르겠다. 제네릭스를 사용하면?
```
Map<String, Sensor> sensors = new HashMap<Sensor>();

Sensor s = (Sensor)sensors.get(sensorId);
```
- 가독성이 크게 높아졌다.
- 위 방법도 클라이언트에게 **꼭 필요한 Map의 기능만을 제공하는 것과는 거리가 멀다**.
  - 여전히 객체를 지울 수 있고 변경할 수 있다.

아래 코드를 보자.
```
public class Sensors {
  private Map sensors = new HashMap();
  
  publi Sensor getById(String id) {
    return (Sensor) sensors.get(id);
  }
  //이하 생략
}
```
- 경계 인터페이스인 Map을 Sensors 안으로 숨겼다! 
  - Sensors 클래스 안에서 객체 유형을 관리하고 변환하고 있기 때문에 제네릭스를 사용하든 사용하지 않든 나머지 프로그램에는 영향을 미치지 않는다.
  - 오진 id만을 가져올 수 있으며 변경, 삭제가 불가능하다.
- 위같이 모든 경계 인터페이스를 캡슐화하라는 것은 아니다. Map같은 경계 인터페이스를 여기저기 넘기지 말라는 뜻이다.

## 경계 살피고 익히기
- 외부 코드를 사용하면 적은 시간에 더 많은 기능을 출시하기 쉽게 한다.
- 우리 자신을 위해 우리가 **사용할 코드를 테스트**하는 것이 좋다. 
- **학습 테스트** : 간단한 테스트 케이스를 작성해 외부 코드를 익히자
  - 학습 테스트는 API를 사용하려는 목적에 초점을 맞춘다.

## 학습 테스트는 공짜 이상이다👍
- 학습 테스트에 드는 비용은 없다.
- 필요한 API의 사용 방법을 익히는 손쉬운 방법이다.
- (신규 버전을 테스트 하지 않게 된다면..) 낡은 버전을 필요 이상으로 오랫동안 사용하려는 유혹에 빠지기 쉽다.

## 아직 존재하지 않는 코드를 사용하기 
- 경계와 관련해 또 다른 유형은 아는 코드와 모르는 코드를 분리하는 경계다.
- 타부서에서 작업중이여서 현재 존재하지 않는 코드라면, 필요한 인터페이스를 정의/구현한다면 우리가 인터페이스를 전적으로 통제할 수 있다.
- 테스트도 간편하게 진행할 수 있다.

## 깨끗한 경계
- SW 설계가 우수하다면 변경하는데 많은 투자와 재작업이 필요하지 않다.
- 통제가 불가능한 외부 패키지에 의존하기 보다는 **통제가 가능한 우리 코드에 의존**하는 편이 훨씬 좋다.
