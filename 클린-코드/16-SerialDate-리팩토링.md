# SerialDate 리팩터링 

JCommon 라이브러리에는 `org.jfree.date`라는 패키지가 있고 그 패키지에는 `SerialDate`이라는 날짜 표현 자바 클래스가 존재한다. 

우수한 코드지만 저자는 보이스카우트 규칙에 의해 더 깨끗한 코드로 리팩터링 하는 과정을 보여줬다. 

> 데이비드(`SerialDate` 개발자)는 그저 우수한 프로그래머가 아니다. 데이비드는 용감하게 자기 코드를 오픈 소스로 공개하는 선의를 보였다. 누구나 사용하고 누구나 비판하라고 코드를 만천하에 공개했다. 참으로 훌륭한 행동이다!

그 중에서도 

## 기억나는 것들
- 알고리즘이 틀렸다.  
  - 훌륭한 개발자의 클래스여도 문제는 발생될 수 있다. 이는 누구에게나 발생할 수 있는 문제이며 우리는 보이스카우트 규칙에 의해서 리팩토링 하면 된다. 
- `SerialDate` => `DayDate` : 정확하지 못하거나 모호한 용어는 의미있는 이름으로 바꾼다.
  - 수도 없이 들었다. 주석보다는 의미 있는 이름을 작명하자. 
- 상수 클래스를 상속하지 말고 필요한 값이 있다면 `enum`을 사용하자. 훨씬 더 간결해질 것이다. 
- 불필요한 주석은 거짓말과 잘못된 정보가 쌓이기 좋은 곳이다. 
  - 주석 잔뜩 보람 코드 반성해😭 
- 하나의 클래스에서만 사용하는 변수라면 해당 클래스에 변수 옮기기 / 여러 클래스에서 사용하는 변수라면 추상 클래스로 옮기기 
- 필요하지 않거나 사용하지 않는 변수 혹은 메서드는 삭제하자. 
- A 메서드에서 C메서드를 호출하기 위해서 B메서드를 호출한다면? A와 B 메서드를 합쳐서 단순화 시키기 
- 일반적으로 메서드 인수로 플래그는 바람직하지 못하다. 
- 구현에 논리적으로 의존한다면 물리적으로도 의존해야 마땅하다. 

## 저자가 한 것들 
- 처음에 나오는 주석은 너무 오래되었다. 그래서 간단하게 고치고 개선했다. 
- enum을 모두 독자적인 소스 파일로 옮겼다.
- 정적 변수(dateFormatSymbols)와 정적 메서드(getMonthNames, isLeapYear, lastDayOfMonth)를 DateUtil이라는 새 클래스로 옮겼다. 
- 일부 추상 메서드를 DayDate 클래스로 끌어올렸다. 
- Month.make를 Month.fromInt로 변경했다. 다른 enum도 똑같이 변경했다. 또한 모든 enum에 toInt() 접근자를 생성하고 index 필드를 private로 정의했다. 
- plusYears와 plusMonths에 흥미로운 중복이 있었다. correctLastDayOfMonth라는 새 메서드를 생성해 중복을 없앴다. 그래서 세 메서드가 모두 좀 더 명확해졌다. 
- 팔방미인으로 사용하던 숫자 1을 없앴다. 모두 Month.JANUARY.toInt() 혹은 Day.SUNDAY.toInt()로 적절히 변경했다. SpreadsheetDate 코드를 살펴보고 알고리즘을 조금 손봤다. 

## 느낀점 
훌륭한 개발자가 다른 사람들에게 코드를 오픈한다는 용기가 그분을 더 대단한 사람으로 느끼게 해준 것 같다.

필요없는 중복과 주석이 보는이들을 더 힘들게 할 수 있구나를 느껴서 반성하게 됐다.
